# ikakbolit - Medication Scheduling App

## –û–ø–∏—Å–∞–Ω–∏–µ
`ikakbolit` ‚Äî —ç—Ç–æ backend-—Å–µ—Ä–≤–∏—Å –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏–µ–º–∞ –ª–µ–∫–∞—Ä—Å—Ç–≤. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç PostgreSQL –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, `gorilla/mux` –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ API-–∑–∞–ø—Ä–æ—Å–æ–≤ –∏ `swaggo/swag` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ OpenAPI-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏.

## –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

### ‚ö° –û—Å–Ω–æ–≤–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:
- **[gorilla/mux](https://github.com/gorilla/mux)** ‚Äî –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤.
- **[PostgreSQL](https://www.postgresql.org)** ‚Äî —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö –∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è—Ö –ø—Ä–∏–µ–º–∞ –ª–µ–∫–∞—Ä—Å—Ç–≤.
- **[pgx](https://github.com/jackc/pgx)** ‚Äî –¥—Ä–∞–π–≤–µ—Ä –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å PostgreSQL, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é —Ä–∞–±–æ—Ç—É —Å –ë–î.
- **[godotenv](https://github.com/joho/godotenv)** ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–∑ `.env`.
- **[swaggo/swag](https://github.com/swaggo/swag)** ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è OpenAPI-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏.
- **[swaggo/http-swagger](https://github.com/swaggo/http-swagger)** ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Swagger UI –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API.
- **[Docker](https://www.docker.com/)** –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞ –∏ —Ç—Ä–µ–±—É–µ–º–æ–π –∏–º –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–≤–æ–¥–∏—Ç—Å—è –≤ docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö.

## –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –∏ –∑–∞–ø—É—Å–∫—É —Å–µ—Ä–≤–∏—Å–∞ —Å –ø–æ–º–æ—â—å—é Dockerüêã

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
```sh
git clone https://github.com/infinity-ocean/ikakbolit.git
cd ikakbolit
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
–°–æ–∑–¥–∞–π `.env` —Ñ–∞–π–ª –∏ —É–∫–∞–∂–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:
```ini
POSTGRES_HOST=localhost       # –•–æ—Å—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
POSTGRES_PORT=5432            # –ü–æ—Ä—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL
POSTGRES_USER=postgres        # –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ë–î
POSTGRES_PASSWORD=12345       # –ü–∞—Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ë–î
POSTGRES_DB=postgres          # –ò–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
POSTGRES_SSL=disable          # –†–µ–∂–∏–º SSL default=disable

DAY_START=08:00               # –í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ –¥–Ω—è –¥–ª—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
DAY_FINISH=21:45              # –í—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è –¥–Ω—è –¥–ª—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
CURE_SCHEDULE_WINDOW_MIN=120  # –ü–µ—Ä–∏–æ–¥ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π –ª–µ–∫–∞—Ä—Å—Ç–≤ (–≤ –º–∏–Ω—É—Ç–∞—Ö)
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```sh
go mod tidy
make install-deps
```

### 4. –ó–∞–ø—É—Å–∫ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö PostgreSQL –≤ Docker
```sh
make start-infra
```

### 5. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
```sh
make migration-up
```

### 6. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```sh
go run internal/cmd/main.go
```

## API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
–î–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ OpenAPI-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–π `swag`:
```sh
swag init -g internal/cmd/main.go
```
–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É:
```
http://localhost:8080/swagger/index.html
```

## –ö—Ä–∞—Ç–∫–æ –ø—Ä–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:
- **POST /schedule**: –î–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∏–µ–º–∞ –ª–µ–∫–∞—Ä—Å—Ç–≤ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –û–∂–∏–¥–∞–µ—Ç JSON —Å –¥–∞–Ω–Ω—ã–º–∏ –æ –ø—Ä–∏–µ–º–µ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Ö –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.
–û–∂–∏–¥–∞–µ–º—ã–π JSON –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞:
```json
{
  "user_id": 1,
  "cure_name": "Paracetamol",
  "doses_per_day": 3,
  "duration": 864000000000000,
}
```
–ü–æ–ª–µ "duration" –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏—ë–º–∞, —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ –Ω–∞–Ω–æ—Å–µ–∫—É–Ω–¥–∞—Ö. 1 –¥–µ–Ω—å = 86400000000000 –Ω–∞–Ω–æ—Å–µ–∫—É–Ω–¥.

- **GET /schedules?user_id=**: –ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ ID —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –¢—Ä–µ–±—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä user_id –≤ query.
- **GET /schedule?user_id=&schedule_id=**: –ü–æ–ª—É—á–∞–µ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∏–µ–º–∞ –ª–µ–∫–∞—Ä—Å—Ç–≤–∞ –ø–æ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ ID —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è. –¢—Ä–µ–±—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã user_id –∏ schedule_id –≤ query.
- **GET /next_takings?user_id**: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –±–ª–∏–∂–∞–π—à–∏—Ö –ø—Ä–∏–µ–º–æ–≤ –ª–µ–∫–∞—Ä—Å—Ç–≤ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –¢—Ä–µ–±—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä user_id –≤ query.
